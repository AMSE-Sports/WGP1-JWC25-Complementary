<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Complementary Ticket Registration • WGP#1</title>

  <!-- Supabase JS Client -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.48.0/dist/umd/supabase.js"></script>
  <script>
    const SUPABASE_URL = 'https://mhecpnqwwxspxfhdvzsc.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1oZWNwbnF3d3hzcHhmaGR2enNjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMwMDc0MjEsImV4cCI6MjA3ODU4MzQyMX0.ONaEMqU6BHuMSywE3Yvtbj78NqBbecI18amsD18Cgnc';

    const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  </script>

  <style>
    :root { 
      --primary:#f37021; 
      --border:#ececec; 
      --ok:#16a34a;

     /* ขยายจากเดิมประมาณ 30% */
  --font-base:    clamp(19px, 2.1vw, 23px);  /* เดิม 15–18px */
  --font-label:   clamp(18px, 1.8vw, 22px);  /* เดิม 14–17px */
  --font-title:   clamp(26px, 3.1vw, 36px);  /* เดิม 20–28px */
  --font-section: clamp(19px, 2.1vw, 25px);  /* เดิม 15–19px */
  --font-note:    clamp(14px, 1.6vw, 18px);  /* เดิม 11–14px */
    }

    * { box-sizing:border-box; }

    body {
      margin:0;
      font-family:system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      background:#fafafa;
      color:#111;
      font-size:var(--font-base);
      width:100%;
      min-height:100vh;
    }

    .header { background:#000; }
    .header img { display:block; width:100%; height:auto; }

    .container { 
      width:100%; 
      max-width:none; 
      margin:0; 
      padding:0; 
    }

    .screen { 
      min-height:100vh; 
      display:flex; 
      flex-direction:column; 
    }

    .card {
      width:100%;
      background:#fff;
      border-radius:0;
      border:0;
      box-shadow:none;
    }

    .head { 
      padding:24px 20px; 
      border-bottom:1px solid var(--border); 
    }
    .head h2 {
      margin:0;
      font-size:var(--font-title);
      font-weight:900;
    }
    .head .note {
      margin-top:6px;
    }

    .body { padding:24px 20px; }

    .row { 
      display:grid; 
      grid-template-columns:1fr; 
      gap:16px; 
      margin-bottom:16px; 
    }
    @media (min-width:760px) { 
      .row.two { grid-template-columns:1fr 1fr; } 
    }

    label.title { 
      font-weight:800; 
      font-size:var(--font-label); 
      margin-bottom:6px; 
      display:block; 
    }
    label .en { 
      font-weight:600; 
      color:#555; 
      margin-left:2px; 
      font-size:calc(var(--font-label) - 1px);
    }

    input, select, textarea {
      width:100%;
      padding:14px 16px;
      border-radius:14px;
      border:1px solid var(--border);
      outline:none;
      background:#fff;
      font-family:inherit;
      font-size:var(--font-base);
      resize:vertical;
    }
    input:focus, select:focus, textarea:focus {
      border-color:var(--primary);
      box-shadow:0 0 0 3px rgba(243,112,33,.2);
    }

    .btn {
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-weight:800;
      border:0;
      padding:18px 24px;
      border-radius:16px;
      cursor:pointer;
      font-size:var(--font-base);
    }
    .btn.primary { 
      background:var(--primary); 
      color:#fff; 
      box-shadow:0 10px 24px -16px rgba(243,112,33,.85); 
    }
    .btn.dark { background:#111; color:#fff; }
    .btn.wide { width:100%; }

    .note { 
      color:#666; 
      font-size:var(--font-note); 
    }

  .hidden { 
  display:none !important; 
}

    .footer { 
      padding:12px 16px; 
      text-align:center; 
      color:#666; 
      font-size:var(--font-note); 
    }

    .thankfull {
      min-height:70vh;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      text-align:center;
      color:#fff;
      background:linear-gradient(135deg, #f37021, #ff8c4a);
      padding:40px 20px;
    }
    .thankfull h2 {
      font-size:clamp(32px, 5vw, 60px);
      font-weight:900;
      letter-spacing:1px;
      margin-bottom:18px;
      text-shadow:0 4px 20px rgba(0,0,0,0.35);
    }
    .thankfull p {
      max-width:720px;
      font-size:clamp(16px, 2vw, 22px);
      line-height:1.6;
      font-weight:500;
      text-shadow:0 2px 10px rgba(0,0,0,0.25);
      margin:0;
    }

    .consent-desc { 
      line-height:1.55; 
      margin-bottom:10px; 
      font-size:var(--font-base);
    }

    label.consent-check { 
      display:flex; 
      gap:10px; 
      align-items:flex-start; 
      font-size:var(--font-base);
    }
    label.consent-check input[type="checkbox"] {
      margin-top:3px;
      flex:0 0 auto;
    }
    label.consent-check span { 
      flex:1 1 auto; 
      line-height:1.5;
    }

    input[type="checkbox"],
input[type="radio"] {
  width: auto;
  transform: scale(1.3);           /* ขยายขนาดประมาณ 30% */
  transform-origin: center left;   /* ให้ขยายแล้วไม่ล้นขึ้นข้างบน */
  accent-color: var(--primary);
}

    .inline-checks { 
      display:flex; 
      flex-wrap:wrap; 
      gap:10px 18px; 
      font-size:var(--font-base);
    }
    .inline-checks label { 
      display:flex; 
      align-items:center; 
      gap:6px; 
      font-size:var(--font-base); 
    }

    .section-title {
      font-weight:900; 
      font-size:var(--font-section); 
      margin:12px 0;
      padding:10px 14px; 
      border-radius:14px;
      background:#fff7f1; 
      border:1px solid #ffe0c4;
      color:#b45309;
    }

    /* Consent modal */
    .modal {
      position:fixed;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:50;
    }
    .modal-backdrop {
      position:absolute;
      inset:0;
      background:rgba(0,0,0,0.55);
    }
    .modal-content {
      position:relative;
      max-width:900px;
      max-height:80vh;
      width:90%;
      background:#fff;
      border-radius:18px;
      padding:24px 20px;
      box-shadow:0 18px 40px rgba(0,0,0,0.4);
      overflow:auto;
      font-size:var(--font-base);
    }
    .modal-content h3 {
      margin-top:0;
      margin-bottom:10px;
      font-size:clamp(18px, 2.2vw, 24px);
      font-weight:800;
    }
    .modal-content h4 {
      margin-top:16px;
      margin-bottom:6px;
      font-size:clamp(16px, 2vw, 20px);
      font-weight:700;
    }
    .modal-content p {
      margin:4px 0 10px;
      line-height:1.6;
    }
    .modal-close {
      position:absolute;
      top:10px;
      right:12px;
      border:0;
      background:transparent;
      font-size:28px;
      line-height:1;
      cursor:pointer;
    }

    .link-btn {
      border:0;
      background:none;
      padding:0;
      margin-left:4px;
      color:var(--primary);
      cursor:pointer;
      text-decoration:underline;
      font-size:var(--font-note);
      font-weight:600;
    }
  </style>
</head>
<body>
  <!-- Header image -->
  <div class="header">
    <img src="Header.png" alt="WGP#1 Waterjet World Cup 2025 Header">
  </div>

  <!-- SCREEN 1: FORM -->
  <section id="screen-form" class="screen container">
    <div class="card">
      <div class="head">
        <h2 style="margin:0;">Complementary Ticket Registration</h2>
        <p class="note" style="margin:4px 0 0;">
          แบบฟอร์มลงทะเบียนผู้รับบัตร Complimentary สำหรับเข้าร่วมงาน WGP#1 Waterjet World Cup 2025
        </p>
      </div>

      <form class="body" id="comp-form">
        <!-- A. Ticket Info -->
        <div class="section-title">A. Ticket Info • ข้อมูลตัวบัตร</div>

        <div class="row">
          <div>
            <label class="title">Ticket Code<span class="en"> / รหัสบัตร Complimentary</span> *</label>

            <div style="display:flex; align-items:center; gap:6px;">
              <span style="
                background:#f3f4f6;
                padding:10px 14px;
                border-radius:12px;
                border:1px solid var(--border);
                font-weight:600;
              ">25-</span>

              <input id="ticket_code_suffix"
                     type="text"
                     maxlength="5"
                     pattern="^[0-9]{5}$"
                     required
                     placeholder="กรอก 5 หลัก เช่น 00001"
                     style="flex:1;">
            </div>

            <div class="note">กรอกเฉพาะตัวเลข 5 หลักท้ายของรหัส Complimentary เช่น 00001</div>

            <!-- full ticket code 25-xxxxx -->
            <input type="hidden" id="ticket_code">
          </div>
        </div>

        <!-- B. Guest Info -->
        <div class="section-title">B. Guest Info • ข้อมูลผู้รับบัตร</div>

        <div class="row two">
          <div>
            <label class="title">ชื่อจริง (TH/EN)<span class="en"> / First Name (TH/EN)</span> *</label>
            <input id="guest_firstname_th" required>
          </div>
          <div>
            <label class="title">นามสกุล (TH/EN)<span class="en"> / Last Name (TH/EN)</span> *</label>
            <input id="guest_lastname_th" required>
            <div class="note">
              กรุณากรอกชื่อ–นามสกุลตามบัตรประชาชนหรือหนังสือเดินทาง • Please use your legal first and last name.
            </div>
          </div>
        </div>

        <!-- C. Contact Info -->
        <div class="section-title">C. Contact Info • ข้อมูลติดต่อ</div>

        <div class="row two">
          <div>
            <label class="title">เบอร์โทรศัพท์ / WhatsApp *</label>
            <input id="contact_phone" required placeholder="+66 ... / +...">
          </div>
          <div>
            <label class="title">ประเทศที่พำนัก<span class="en"> / Country of Residence</span> *</label>
            <select id="guest_country" required>
              <option value="">— เลือกประเทศ / Select Country —</option>
              <option value="Thailand">Thailand</option>
              <option value="Afghanistan">Afghanistan</option>
              <option value="Albania">Albania</option>
              <option value="Algeria">Algeria</option>
              <option value="Andorra">Andorra</option>
              <option value="Angola">Angola</option>
              <option value="Antigua and Barbuda">Antigua and Barbuda</option>
              <option value="Argentina">Argentina</option>
              <option value="Armenia">Armenia</option>
              <option value="Australia">Australia</option>
              <option value="Austria">Austria</option>
              <option value="Azerbaijan">Azerbaijan</option>
              <option value="Bahamas">Bahamas</option>
              <option value="Bahrain">Bahrain</option>
              <option value="Bangladesh">Bangladesh</option>
              <option value="Barbados">Barbados</option>
              <option value="Belarus">Belarus</option>
              <option value="Belgium">Belgium</option>
              <option value="Belize">Belize</option>
              <option value="Benin">Benin</option>
              <option value="Bhutan">Bhutan</option>
              <option value="Bolivia">Bolivia</option>
              <option value="Bosnia and Herzegovina">Bosnia and Herzegovina</option>
              <option value="Botswana">Botswana</option>
              <option value="Brazil">Brazil</option>
              <option value="Brunei">Brunei</option>
              <option value="Bulgaria">Bulgaria</option>
              <option value="Burkina Faso">Burkina Faso</option>
              <option value="Burundi">Burundi</option>
              <option value="Cambodia">Cambodia</option>
              <option value="Cameroon">Cameroon</option>
              <option value="Canada">Canada</option>
              <option value="Cape Verde">Cape Verde</option>
              <option value="Central African Republic">Central African Republic</option>
              <option value="Chad">Chad</option>
              <option value="Chile">Chile</option>
              <option value="China">China</option>
              <option value="Colombia">Colombia</option>
              <option value="Comoros">Comoros</option>
              <option value="Congo">Congo</option>
              <option value="Costa Rica">Costa Rica</option>
              <option value="Côte d’Ivoire">Côte d’Ivoire</option>
              <option value="Croatia">Croatia</option>
              <option value="Cuba">Cuba</option>
              <option value="Cyprus">Cyprus</option>
              <option value="Czechia">Czechia</option>
              <option value="Democratic Republic of the Congo">Democratic Republic of the Congo</option>
              <option value="Denmark">Denmark</option>
              <option value="Djibouti">Djibouti</option>
              <option value="Dominica">Dominica</option>
              <option value="Dominican Republic">Dominican Republic</option>
              <option value="Ecuador">Ecuador</option>
              <option value="Egypt">Egypt</option>
              <option value="El Salvador">El Salvador</option>
              <option value="Equatorial Guinea">Equatorial Guinea</option>
              <option value="Eritrea">Eritrea</option>
              <option value="Estonia">Estonia</option>
              <option value="Eswatini">Eswatini</option>
              <option value="Ethiopia">Ethiopia</option>
              <option value="Fiji">Fiji</option>
              <option value="Finland">Finland</option>
              <option value="France">France</option>
              <option value="Gabon">Gabon</option>
              <option value="Gambia">Gambia</option>
              <option value="Georgia">Georgia</option>
              <option value="Germany">Germany</option>
              <option value="Ghana">Ghana</option>
              <option value="Greece">Greece</option>
              <option value="Grenada">Grenada</option>
              <option value="Guatemala">Guatemala</option>
              <option value="Guinea">Guinea</option>
              <option value="Guinea-Bissau">Guinea-Bissau</option>
              <option value="Guyana">Guyana</option>
              <option value="Haiti">Haiti</option>
              <option value="Honduras">Honduras</option>
              <option value="Hong Kong">Hong Kong</option>
              <option value="Hungary">Hungary</option>
              <option value="Iceland">Iceland</option>
              <option value="India">India</option>
              <option value="Indonesia">Indonesia</option>
              <option value="Iran">Iran</option>
              <option value="Iraq">Iraq</option>
              <option value="Ireland">Ireland</option>
              <option value="Israel">Israel</option>
              <option value="Italy">Italy</option>
              <option value="Jamaica">Jamaica</option>
              <option value="Japan">Japan</option>
              <option value="Jordan">Jordan</option>
              <option value="Kazakhstan">Kazakhstan</option>
              <option value="Kenya">Kenya</option>
              <option value="Kiribati">Kiribati</option>
              <option value="Kuwait">Kuwait</option>
              <option value="Kyrgyzstan">Kyrgyzstan</option>
              <option value="Laos">Laos</option>
              <option value="Latvia">Latvia</option>
              <option value="Lebanon">Lebanon</option>
              <option value="Lesotho">Lesotho</option>
              <option value="Liberia">Liberia</option>
              <option value="Libya">Libya</option>
              <option value="Liechtenstein">Liechtenstein</option>
              <option value="Lithuania">Lithuania</option>
              <option value="Luxembourg">Luxembourg</option>
              <option value="Madagascar">Madagascar</option>
              <option value="Malawi">Malawi</option>
              <option value="Malaysia">Malaysia</option>
              <option value="Maldives">Maldives</option>
              <option value="Mali">Mali</option>
              <option value="Malta">Malta</option>
              <option value="Marshall Islands">Marshall Islands</option>
              <option value="Mauritania">Mauritania</option>
              <option value="Mauritius">Mauritius</option>
              <option value="Mexico">Mexico</option>
              <option value="Micronesia">Micronesia</option>
              <option value="Moldova">Moldova</option>
              <option value="Monaco">Monaco</option>
              <option value="Mongolia">Mongolia</option>
              <option value="Montenegro">Montenegro</option>
              <option value="Morocco">Morocco</option>
              <option value="Mozambique">Mozambique</option>
              <option value="Myanmar">Myanmar</option>
              <option value="Namibia">Namibia</option>
              <option value="Nauru">Nauru</option>
              <option value="Nepal">Nepal</option>
              <option value="Netherlands">Netherlands</option>
              <option value="New Zealand">New Zealand</option>
              <option value="Nicaragua">Nicaragua</option>
              <option value="Niger">Niger</option>
              <option value="Nigeria">Nigeria</option>
              <option value="North Korea">North Korea</option>
              <option value="North Macedonia">North Macedonia</option>
              <option value="Norway">Norway</option>
              <option value="Oman">Oman</option>
              <option value="Pakistan">Pakistan</option>
              <option value="Palau">Palau</option>
              <option value="Panama">Panama</option>
              <option value="Papua New Guinea">Papua New Guinea</option>
              <option value="Paraguay">Paraguay</option>
              <option value="Peru">Peru</option>
              <option value="Philippines">Philippines</option>
              <option value="Poland">Poland</option>
              <option value="Portugal">Portugal</option>
              <option value="Qatar">Qatar</option>
              <option value="Romania">Romania</option>
              <option value="Russia">Russia</option>
              <option value="Rwanda">Rwanda</option>
              <option value="Saint Kitts and Nevis">Saint Kitts and Nevis</option>
              <option value="Saint Lucia">Saint Lucia</option>
              <option value="Saint Vincent and the Grenadines">Saint Vincent and the Grenadines</option>
              <option value="Samoa">Samoa</option>
              <option value="San Marino">San Marino</option>
              <option value="Sao Tome and Principe">Sao Tome and Principe</option>
              <option value="Saudi Arabia">Saudi Arabia</option>
              <option value="Senegal">Senegal</option>
              <option value="Serbia">Serbia</option>
              <option value="Seychelles">Seychelles</option>
              <option value="Sierra Leone">Sierra Leone</option>
              <option value="Singapore">Singapore</option>
              <option value="Slovakia">Slovakia</option>
              <option value="Slovenia">Slovenia</option>
              <option value="Solomon Islands">Solomon Islands</option>
              <option value="Somalia">Somalia</option>
              <option value="South Africa">South Africa</option>
              <option value="South Korea">South Korea</option>
              <option value="South Sudan">South Sudan</option>
              <option value="Spain">Spain</option>
              <option value="Sri Lanka">Sri Lanka</option>
              <option value="Sudan">Sudan</option>
              <option value="Suriname">Suriname</option>
              <option value="Sweden">Sweden</option>
              <option value="Switzerland">Switzerland</option>
              <option value="Syria">Syria</option>
              <option value="Taiwan">Taiwan</option>
              <option value="Tajikistan">Tajikistan</option>
              <option value="Tanzania">Tanzania</option>
              <option value="Timor-Leste">Timor-Leste</option>
              <option value="Togo">Togo</option>
              <option value="Tonga">Tonga</option>
              <option value="Trinidad and Tobago">Trinidad and Tobago</option>
              <option value="Tunisia">Tunisia</option>
              <option value="Turkey">Turkey</option>
              <option value="Turkmenistan">Turkmenistan</option>
              <option value="Tuvalu">Tuvalu</option>
              <option value="Uganda">Uganda</option>
              <option value="Ukraine">Ukraine</option>
              <option value="United Arab Emirates">United Arab Emirates</option>
              <option value="United Kingdom">United Kingdom</option>
              <option value="United States">United States</option>
              <option value="Uruguay">Uruguay</option>
              <option value="Uzbekistan">Uzbekistan</option>
              <option value="Vanuatu">Vanuatu</option>
              <option value="Venezuela">Venezuela</option>
              <option value="Vietnam">Vietnam</option>
              <option value="Yemen">Yemen</option>
              <option value="Zambia">Zambia</option>
              <option value="Zimbabwe">Zimbabwe</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div>
            <label class="title">เมือง / จังหวัด<span class="en"> / City</span> *</label>
            <input id="guest_city" required pattern="[\u0E00-\u0E7F a-zA-Z\- ]+" placeholder="เช่น Bangkok / Pattaya">
            <div class="note">รองรับอักษรไทย/อังกฤษและช่องว่างเท่านั้น • Thai/English letters & spaces only</div>
          </div>
        </div>

        <!-- D. Attendance -->
        <div class="section-title">D. Attendance Info • วันที่เข้าร่วมงาน</div>

        <div class="row">
          <div>
            <label class="title">เลือกวันที่จะเข้าร่วม<span class="en"> / Which day(s) will you attend?</span> *</label>
            <div class="inline-checks" id="attend_days_group">
              <label><input type="checkbox" value="Wed 17 Dec"> <span>Wed 17 Dec</span></label>
              <label><input type="checkbox" value="Thu 18 Dec"> <span>Thu 18 Dec</span></label>
              <label><input type="checkbox" value="Fri 19 Dec"> <span>Fri 19 Dec</span></label>
              <label><input type="checkbox" value="Sat 20 Dec"> <span>Sat 20 Dec</span></label>
              <label><input type="checkbox" value="Sun 21 Dec"> <span>Sun 21 Dec</span></label>
            </div>
            <div class="note">กรุณาเลือกอย่างน้อย 1 วัน • Please select at least one day.</div>
          </div>
        </div>

        <!-- E. Consent -->
        <div class="section-title">E. PDPA & Media Consent</div>

        <div class="row">
          <div>
            <label class="title">การจัดเก็บและใช้ข้อมูลส่วนบุคคล<span class="en"> / PDPA Consent</span> *</label>
            <div class="note">
              โปรดอ่านรายละเอียดนโยบายข้อมูล และการใช้ภาพ/วิดีโอ ก่อนทำเครื่องหมายยินยอม
             <button type="button" class="link-btn" id="open-consent-modal">
  อ่านรายละเอียด / Read more
</button>
            </div>
            <label class="consent-check">
              <input type="checkbox" id="pdpa_consent" required>
              <span>ฉันได้อ่านและยินยอมให้จัดเก็บและใช้ข้อมูลส่วนบุคคลตามที่ระบุไว้ • I have read and consent to the use of my personal data.</span>
            </label>
          </div>
        </div>

        <div class="row">
          <div>
            <label class="title">การบันทึกภาพและวิดีโอ<span class="en"> / Media (Photo & Video) Consent</span> *</label>
            <label class="consent-check">
              <input type="checkbox" id="media_consent" required>
              <span>ฉันได้อ่านและยินยอมตามเงื่อนไขการบันทึกภาพและวิดีโอข้างต้น • I have read and consent to the media conditions above.</span>
            </label>
          </div>
        </div>

        <button class="btn primary wide" type="submit" id="submit-btn">
          ยืนยันรับบัตร Complimentary • Submit Complimentary Ticket Form
        </button>
      </form>
    </div>

    <div class="footer">© 2025 WGP#1 • Complementary Ticket Registration</div>
  </section>

  <!-- SCREEN 2: THANK YOU -->
  <section id="screen-thank" class="screen container hidden">
    <div class="card">
      <div class="thankfull">
        <h2>THANK YOU!</h2>
        <p>
          Thank you for being part of this world-class competition — we hope you enjoy an unforgettable and thrilling experience!<br><br>
          ขอบคุณที่ร่วมเป็นส่วนหนึ่งของการแข่งขันระดับโลกครั้งนี้ — ขอให้คุณสนุกกับประสบการณ์สุดมันส์!
        </p>
      </div>
      <div class="body" style="text-align:center">
        <button class="btn dark" id="back-to-form">
          กรอกแบบฟอร์มสำหรับบัตรใบถัดไป • New Entry
        </button>
      </div>
    </div>
  </section>

  <!-- Consent Modal -->
  <div id="consent-modal" class="modal hidden">
    <div id="consent-modal-backdrop" class="modal-backdrop"></div>
    <div class="modal-content">
      <button type="button" class="modal-close" id="close-consent-modal">&times;</button>
      <h3>PDPA & Media Consent Details</h3>

      <h4>TH: ข้อมูลส่วนบุคคล</h4>
      <p>
        ข้อมูลที่กรอกในแบบฟอร์มนี้จะถูกใช้เพื่อการจัดการงาน ที่นั่ง พิธีการ และการติดต่อประสานงานเกี่ยวกับงาน
        WGP#1 Waterjet World Cup 2025 เท่านั้น และจะไม่ถูกนำไปใช้เพื่อวัตถุประสงค์อื่นโดยไม่ได้รับความยินยอม
      </p>

      <h4>EN: Personal Data (PDPA)</h4>
      <p>
        The personal data you provide in this form will be used only for event management, seating, protocol, and coordination
        related to the WGP#1 Waterjet World Cup 2025. It will not be used for any other purposes without your further consent.
      </p>

      <hr>

      <h4>EN: Media (Photo & Video)</h4>
      <p>
        By attending the WGP#1 Waterjet World Cup 2025, which includes live broadcasting and global media coverage, you grant
        the event organizers and their partners the right to photograph, film, and record your image and voice for use in
        promotions, advertising, live streams, and other media—without the need for further consent or compensation.
        Entering the event area constitutes full and unconditional consent. If you do not wish to appear in such media,
        please avoid camera zones or broadcast areas.
      </p>

      <h4>TH: การบันทึกภาพและวิดีโอ</h4>
      <p>
        ในการเข้าชมการแข่งขัน WGP#1 Waterjet World Cup 2025 ซึ่งมีการถ่ายทอดสดและเผยแพร่สู่สาธารณะทั่วโลก
        ท่านยินยอมให้ผู้จัดงานและพันธมิตร สามารถบันทึกภาพนิ่ง วิดีโอ และเสียงของท่าน เพื่อใช้ในสื่อประชาสัมพันธ์
        โฆษณา ถ่ายทอดสด และสื่ออื่น ๆ โดยไม่ต้องขออนุญาตหรือจ่ายค่าตอบแทนใด ๆ เพิ่มเติม
        การเข้าสู่พื้นที่จัดงาน ถือเป็นการให้ความยินยอมโดยสมบูรณ์ หากไม่ประสงค์ให้ถูกบันทึกภาพ
        โปรดหลีกเลี่ยงบริเวณกล้องหรือพื้นที่ถ่ายทอดสด
      </p>
    </div>
  </div>

  <script>
    function showScreen(id) {
      document.getElementById('screen-form').classList.add('hidden');
      document.getElementById('screen-thank').classList.add('hidden');
      document.getElementById(id).classList.remove('hidden');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Modal for Consent details
    (function initConsentModal() {
      const modal = document.getElementById('consent-modal');
      const openBtn = document.getElementById('open-consent-modal');
      const closeBtn = document.getElementById('close-consent-modal');
      const backdrop = document.getElementById('consent-modal-backdrop');

      if (!modal || !openBtn || !closeBtn || !backdrop) return;

      function openModal() {
        modal.classList.remove('hidden');
      }

      function closeModal() {
        modal.classList.add('hidden');
      }

      openBtn.addEventListener('click', openModal);
      closeBtn.addEventListener('click', closeModal);
      backdrop.addEventListener('click', closeModal);
    })();

    // ประกอบ Ticket Code = 25-xxxxx จาก suffix
    (function initTicketCode() {
      const suffixInput = document.getElementById('ticket_code_suffix');
      const fullCodeHidden = document.getElementById('ticket_code');

      suffixInput.addEventListener('input', function () {
        this.value = this.value.replace(/[^0-9]/g, '');
        if (this.value.length > 5) {
          this.value = this.value.slice(0, 5);
        }
        if (this.value.length === 5) {
          fullCodeHidden.value = '25-' + this.value;
        } else {
          fullCodeHidden.value = '';
        }
      });
    })();

    // Submit -> Supabase insert
    document.getElementById('comp-form').addEventListener('submit', async function (e) {
      e.preventDefault();

      // ==== ตรวจสอบ Ticket Code (5 หลัก + ประกอบรหัส) ====
      const suffixInput = document.getElementById('ticket_code_suffix');
      const fullCodeHidden = document.getElementById('ticket_code');
      const ticketSuffix = (suffixInput.value || '').trim();

      if (!/^[0-9]{5}$/.test(ticketSuffix)) {
        alert('กรุณากรอกเลข 5 หลักท้ายของรหัสบัตร (เฉพาะตัวเลข 0–9) เช่น 00001');
        suffixInput.focus();
        return;
      }

      const ticketCode = '25-' + ticketSuffix;
      fullCodeHidden.value = ticketCode;

      // ==== ตรวจชื่อจริงและนามสกุล ====
      const firstNameTh = document.getElementById('guest_firstname_th').value.trim();
      const lastNameTh = document.getElementById('guest_lastname_th').value.trim();

      if (!firstNameTh || !lastNameTh) {
        alert('กรุณากรอกชื่อจริงและนามสกุลให้ครบถ้วน');
        return;
      }
      const guestFullnameTh = firstNameTh + ' ' + lastNameTh;

      // ==== ตรวจอย่างน้อย 1 วัน ====
      var dayChecks = document.querySelectorAll('#attend_days_group input[type=checkbox]');
      var selectedDays = [];
      dayChecks.forEach(function (ch) {
        if (ch.checked) selectedDays.push(ch.value);
      });
      if (selectedDays.length === 0) {
        alert('กรุณาเลือกวันที่จะเข้าร่วมอย่างน้อย 1 วัน / Please select at least one day.');
        return;
      }

      // ==== เช็คเลขซ้ำบน Supabase ====
      try {
        const { error: dupError, count } = await sb
          .from('complementary_tickets')
          .select('id', { count: 'exact', head: true })
          .eq('ticket_code', ticketCode);

        if (dupError) {
          console.error('Duplicate check error:', dupError);
          alert('ไม่สามารถตรวจสอบรหัสบัตรได้ในขณะนี้ กรุณาลองใหม่อีกครั้ง หรือแจ้งเจ้าหน้าที่');
          return;
        }

        if (count && count > 0) {
          alert('รหัสบัตร ' + ticketCode + ' ถูกใช้ไปแล้ว กรุณาใช้หมายเลขอื่น');
          return;
        }
      } catch (err) {
        console.error('Unexpected duplicate check error:', err);
        alert('เกิดข้อผิดพลาดในการตรวจสอบรหัสบัตร กรุณาลองใหม่อีกครั้ง');
        return;
      }

      var btn = document.getElementById('submit-btn');
      var oldText = btn.textContent;
      btn.textContent = 'กำลังส่ง... / Submitting...';
      btn.disabled = true;

      var payload = {
        submitted_at: new Date().toISOString(),

        ticket_code: ticketCode,

        // Guest fields ปรับให้เหลือ Fullname TH อย่างเดียว
        guest_title: null,
        guest_fullname_th: guestFullnameTh,
        guest_fullname_en: null,
        guest_position: null,
        guest_company: null,

        // Contact
        contact_email: null,
        contact_phone: document.getElementById('contact_phone').value.trim() || null,
        guest_country: document.getElementById('guest_country').value || null,
        guest_city: document.getElementById('guest_city').value.trim() || null,

        attend_days: selectedDays.join(', '),

        pdpa_consent: document.getElementById('pdpa_consent').checked,
        media_consent: document.getElementById('media_consent').checked
      };

      try {
        const { error } = await sb
          .from('complementary_tickets')
          .insert([payload]);

        if (error) {
          console.error('Supabase insert error:', error);

          if (error.code === '23505') {
            alert('รหัสบัตร ' + ticketCode + ' ถูกใช้ไปแล้วในระบบ กรุณาใช้หมายเลขอื่นหรือรีเช็กกับเจ้าหน้าที่');
          } else {
            alert('บันทึกข้อมูลไม่สำเร็จ กรุณาลองอีกครั้ง หรือแจ้งเจ้าหน้าที่\n\nError: ' + error.message);
          }
        } else {
          document.getElementById('comp-form').reset();
          showScreen('screen-thank');
        }
      } catch (err) {
        console.error('Unexpected error:', err);
        alert('เกิดข้อผิดพลาดในการเชื่อมต่อระบบ กรุณาลองใหม่อีกครั้ง');
      } finally {
        btn.textContent = oldText;
        btn.disabled = false;
      }
    });

    document.getElementById('back-to-form').addEventListener('click', function () {
      showScreen('screen-form');
    });
  </script>
</body>
</html>
